(function(){function d(d){var h={},g={},a={},b={};return{Set:function(a,c){h[a]=c;if(g.hasOwnProperty(a)){var b=g[a],f;for(f in b)b[f](c)}},SetEnlarger:function(a,c){b[a]=c},GetEnlarger:function(a){return b[a]},Watch:function(a,c){g.hasOwnProperty(a)||(g[a]=[]);g[a].push(c)},Has:function(a){return h.hasOwnProperty(a)},OnMove:function(b,c,g){if(a.hasOwnProperty(b)){var f=a[b],e;for(e in f)f[e](c,g,h[b])}},RegisterOnMove:function(b,c){a.hasOwnProperty(b)||(a[b]=[]);a[b].push(c)},DoctorClass:function(){return function(l){this.log=
l;this.valmap=h;this.fnmap=g;this.event_onmovemap=a;this.enlarge_objmap=b}}}}angular.module("npImageServices",[]).service({npImageSvc:d});d.$inject=["$log"]})();
(function(){function d(d,g){return{restrict:"E",scope:{label:"@",src:"@",width:"@",height:"@",click:"&npOnclick",enter:"&npOnenter",leave:"&npOnleave"},template:'<div style="z-index:1000"></div>',replace:!0,controller:["$log","$scope","$element",function(a,b,l){var c=!1;this.Move=function(a,f){var e,d,h;b.$applyAsync(function(){b.enter()});c?c.css("display",""):(c=angular.element("<div></div>"),c.on("click",function(a){b.$applyAsync(function(){b.click()})}),l.prepend(c),c.css({backgroundColor:"rgb(84, 84, 224)",
zIndex:1E3,opacity:.25}),c.on("mousemove",function(a){var f=parseInt(c.css("left")),e=parseInt(c.css("top"));isNaN(f)&&(f=0);isNaN(e)&&(e=0);var l=parseInt(c.css("width"))/2,n=parseInt(c.css("height"))/2,m=parseInt(b.width),k=parseInt(b.height),f=f+((void 0==a.offsetX?a.layerX:a.offsetX)-l);a=e+((void 0==a.offsetY?a.layerY:a.offsetY)-n);f<=m+5&&-d-5<=f?c.css({left:f+"px"}):(c.css({display:"none"}),b.$applyAsync(function(){b.leave()}));a<=k+5&&-h-5<=a?c.css({top:a+"px"}):(c.css({display:"none"}),b.$applyAsync(function(){b.leave()}));
g.OnMove(b.label,f,a)}));var m=g.GetEnlarger(b.label);angular.isDefined(m)&&(e=m.scale,d=m.width/e,h=m.height/e,c.css({width:d+"px",height:h+"px",left:a-d/2+"px",top:f-h/2+"px",position:"absolute"}))}}],link:{post:function(a,b,l,c){var d=angular.element("<img src='"+a.src+"'>");b.append(d);angular.isString(a.width)&&0<a.width.length&&d.css("width",a.width);angular.isString(a.height)&&0<a.height.length&&d.css("height",a.height);d.css("zIndex",1E3);g.Set(a.label,{w:a.width,h:a.height,label:a.label,
src:a.src});d.on("mousemove",function(b){var e=!1;angular.isUndefined(a.height)&&(a.height=d.prop("height"),e=!0);angular.isUndefined(a.width)&&(a.width=d.prop("width"),e=!0);e&&g.Set(a.label,{w:a.width,h:a.height,label:a.label,src:a.src});e=void 0==b.offsetX?b.layerX:b.offsetX;b=void 0==b.offsetY?b.layerY:b.offsetY;c.Move(e,b);g.OnMove(a.label,e,b)})}}}}function k(d,g){return{restrict:"E",scope:{width:"@npWidth",height:"@npHeight",label:"@",zoomperc:"@",srcEnlarged:"@"},controller:["$scope","$element",
function(a,b){var d=!1;this.Move=function(c,h,f){var e=g.GetEnlarger(a.label);if(!d){var k=angular.isString(a.srcEnlarged)&&0<a.srcEnlarged.length?a.srcEnlarged:f.src;d=angular.element("<img src='"+k+"'/>");d.css({width:f.w*e.scale+"px",height:f.h*e.scale+"px",position:"absolute"});b.append(d)}d.css({left:-(c*e.scale)+"px",top:-(h*e.scale)+"px"})}}],link:{post:function(a,b,d,c){0<parseInt(a.width)||(a.width=200);0<parseInt(a.height)||(a.height=200);if(!g.Has(a.label))throw"cannot find label="+a.label;
b.css({width:a.width+"px",height:a.height+"px",position:"absolute",overflow:"hidden"});g.SetEnlarger(a.label,{width:a.width,height:a.height,zoomperc:a.zoomperc,scale:1+a.zoomperc/100});g.RegisterOnMove(a.label,c.Move)}}}}angular.module("npImageWidgets.Enlarger",["npImageServices"]).directive({npImage:d,npImageEnlarge:k});d.$inject=["$log","npImageSvc"];k.$inject=["$log","npImageSvc"]})();
